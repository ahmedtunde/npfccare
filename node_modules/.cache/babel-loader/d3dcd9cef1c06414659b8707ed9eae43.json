{"ast":null,"code":"import _slicedToArray from\"/Users/xerde2/Downloads/npf-admin-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/xerde2/Downloads/npf-admin-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"/Users/xerde2/Downloads/npf-admin-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import{jsx as _jsx}from\"react/jsx-runtime\";import numeral from\"numeral\";import React,{createContext,useContext,useState}from\"react\";import{Redirect,Route,useLocation}from\"react-router-dom\";import{clearAllTokens,clearRoles,clearToken,clearLoanRoles,clearBranchId,getAccessToken,clearEmail}from\"../utils/localStorageService\";var authContext=/*#__PURE__*/createContext();export var useAuth=function useAuth(_){return useContext(authContext);};// app wrapper granting access to the authentication context\nexport var ProvideAuth=function ProvideAuth(props){var auth=useProvideAuth();return/*#__PURE__*/_jsx(authContext.Provider,{value:auth,children:props.children});};// private route component\nexport var PrivateRoute=function PrivateRoute(_ref){var children=_ref.children,rest=_objectWithoutProperties(_ref,[\"children\"]);var auth=useAuth();return/*#__PURE__*/_jsx(Route,_objectSpread(_objectSpread({},rest),{},{render:function render(_ref2){var location=_ref2.location;return auth.user?children:/*#__PURE__*/_jsx(Redirect,{to:{pathname:\"/login\",state:{from:location}}});}}));};// fake authentication state object\nvar fakeAuth={isAuthenticated:false,signin:function signin(cb){fakeAuth.isAuthenticated=true;setTimeout(cb,1000);// fake async\n},signout:function signout(cb){fakeAuth.isAuthenticated=false;setTimeout(cb,3000);}};// the authentication method\nfunction useProvideAuth(){function getRoles(){var token=getAccessToken();if(!token)return null;var tokenDetails=JSON.parse(atob(token.split(\".\")[1]));return tokenDetails.roles;}var _useState=useState(function(){return getRoles();}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var signin=function signin(){var cb=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};setUser(getRoles());cb();// setTimeout(cb(), 500);\n// return fakeAuth.signin(() => {\n//   setUser(\"user\");\n//   if(cb) cb();\n// });\n};var signout=function signout(){var cb=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){};setUser(null);clearToken();clearRoles();clearLoanRoles();clearBranchId();clearEmail();clearAllTokens();// return fakeAuth.signout(() => {\n//   setUser(null);\n//   if(cb) cb();\n// });\n};return{user:user,signin:signin,signout:signout};}export var handleOpenModal=function handleOpenModal(modalSelector){var cb=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};return document.$(modalSelector).modal(\"show\").on(\"hidden.bs.modal\",cb);};export var handleHideModal=function handleHideModal(modalSelector){var cb=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};return document.$(modalSelector).modal(\"hide\").on(\"hidden.bs.modal\",cb);};export var isAlphaNumeric=function isAlphaNumeric(string){var re=/^.*(?=.*[a-z])(?=.*\\d)/;return re.test(string);};export var isValidDate=function isValidDate(date){console.log(date);return!!(date&&Object.prototype.toString.call(date)===\"[object Date]\"&&!isNaN(date));};export var formatAmount=function formatAmount(amount){return numeral(amount).format(\"0,0.00\");};export var useQueryParams=function useQueryParams(){return new URLSearchParams(useLocation().search);};","map":{"version":3,"sources":["/Users/xerde2/Downloads/npf-admin-web/src/components/utilities.js"],"names":["numeral","React","createContext","useContext","useState","Redirect","Route","useLocation","clearAllTokens","clearRoles","clearToken","clearLoanRoles","clearBranchId","getAccessToken","clearEmail","authContext","useAuth","_","ProvideAuth","props","auth","useProvideAuth","children","PrivateRoute","rest","location","user","pathname","state","from","fakeAuth","isAuthenticated","signin","cb","setTimeout","signout","getRoles","token","tokenDetails","JSON","parse","atob","split","roles","setUser","handleOpenModal","modalSelector","document","$","modal","on","handleHideModal","isAlphaNumeric","string","re","test","isValidDate","date","console","log","Object","prototype","toString","call","isNaN","formatAmount","amount","format","useQueryParams","URLSearchParams","search"],"mappings":"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","sourcesContent":["import numeral from \"numeral\";\nimport React, { createContext, useContext, useState } from \"react\";\nimport { Redirect, Route, useLocation } from \"react-router-dom\";\nimport {\n  clearAllTokens,\n  clearRoles,\n  clearToken,\n  clearLoanRoles,\n  clearBranchId,\n  getAccessToken,\n  clearEmail,\n} from \"../utils/localStorageService\";\n\nconst authContext = createContext();\n\nexport const useAuth = (_) => useContext(authContext);\n\n// app wrapper granting access to the authentication context\nexport const ProvideAuth = (props) => {\n  const auth = useProvideAuth();\n  return (\n    <authContext.Provider value={auth}>{props.children}</authContext.Provider>\n  );\n};\n\n// private route component\nexport const PrivateRoute = ({ children, ...rest }) => {\n  const auth = useAuth();\n  return (\n    <Route\n      {...rest}\n      render={({ location }) =>\n        auth.user ? (\n          children\n        ) : (\n          <Redirect\n            to={{\n              pathname: \"/login\",\n              state: { from: location },\n            }}\n          />\n        )\n      }\n    />\n  );\n};\n\n// fake authentication state object\nconst fakeAuth = {\n  isAuthenticated: false,\n  signin(cb) {\n    fakeAuth.isAuthenticated = true;\n    setTimeout(cb, 1000); // fake async\n  },\n  signout(cb) {\n    fakeAuth.isAuthenticated = false;\n    setTimeout(cb, 3000);\n  },\n};\n\n// the authentication method\nfunction useProvideAuth() {\n  function getRoles() {\n    const token = getAccessToken();\n    if (!token) return null;\n    const tokenDetails = JSON.parse(atob(token.split(\".\")[1]));\n    return tokenDetails.roles;\n  }\n  const [user, setUser] = useState(() => getRoles());\n\n  const signin = (cb = () => {}) => {\n    setUser(getRoles());\n    cb();\n    // setTimeout(cb(), 500);\n    // return fakeAuth.signin(() => {\n    //   setUser(\"user\");\n    //   if(cb) cb();\n    // });\n  };\n\n  const signout = (cb = () => {}) => {\n    setUser(null);\n    clearToken();\n    clearRoles();\n    clearLoanRoles();\n    clearBranchId();\n    clearEmail();\n    clearAllTokens();\n    // return fakeAuth.signout(() => {\n    //   setUser(null);\n    //   if(cb) cb();\n    // });\n  };\n\n  return {\n    user,\n    signin,\n    signout,\n  };\n}\n\nexport const handleOpenModal = (modalSelector, cb = () => {}) =>\n  document.$(modalSelector).modal(\"show\").on(\"hidden.bs.modal\", cb);\n\nexport const handleHideModal = (modalSelector, cb = () => {}) =>\n  document.$(modalSelector).modal(\"hide\").on(\"hidden.bs.modal\", cb);\n\nexport const isAlphaNumeric = (string) => {\n  let re = /^.*(?=.*[a-z])(?=.*\\d)/;\n  return re.test(string);\n};\n\nexport const isValidDate = (date) => {\n  console.log(date);\n  return !!(\n    date &&\n    Object.prototype.toString.call(date) === \"[object Date]\" &&\n    !isNaN(date)\n  );\n};\n\nexport const formatAmount = (amount) => numeral(amount).format(\"0,0.00\");\n\nexport const useQueryParams = () => {\n  return new URLSearchParams(useLocation().search);\n};\n"]},"metadata":{},"sourceType":"module"}