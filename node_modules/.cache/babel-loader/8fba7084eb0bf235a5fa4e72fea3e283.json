{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/xerde2/Downloads/npf-admin-web/src/components/utilities.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$(),\n    _s5 = $RefreshSig$();\n\nimport numeral from \"numeral\";\nimport React, { createContext, useContext, useState } from \"react\";\nimport { Redirect, Route, useLocation } from \"react-router-dom\";\nimport { clearAllTokens, clearRoles, clearToken, clearLoanRoles, clearBranchId, getAccessToken, clearEmail } from \"../utils/localStorageService\";\nconst authContext = /*#__PURE__*/createContext();\nexport const useAuth = _ => {\n  _s();\n\n  return useContext(authContext);\n}; // app wrapper granting access to the authentication context\n\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nexport const ProvideAuth = props => {\n  _s2();\n\n  const auth = useProvideAuth();\n  return /*#__PURE__*/_jsxDEV(authContext.Provider, {\n    value: auth,\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 22,\n    columnNumber: 5\n  }, this);\n}; // private route component\n\n_s2(ProvideAuth, \"XNU4Jn8u4aVzJknlKOHFJq03xMo=\", false, function () {\n  return [useProvideAuth];\n});\n\n_c = ProvideAuth;\nexport const PrivateRoute = _ref => {\n  _s3();\n\n  let {\n    children,\n    ...rest\n  } = _ref;\n  const auth = useAuth();\n  return /*#__PURE__*/_jsxDEV(Route, { ...rest,\n    render: _ref2 => {\n      let {\n        location\n      } = _ref2;\n      return auth.user ? children : /*#__PURE__*/_jsxDEV(Redirect, {\n        to: {\n          pathname: \"/login\",\n          state: {\n            from: location\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 11\n      }, this);\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 30,\n    columnNumber: 5\n  }, this);\n}; // fake authentication state object\n\n_s3(PrivateRoute, \"YuJWYXaKIY31b1y7U6yy3IXSxQA=\", false, function () {\n  return [useAuth];\n});\n\n_c2 = PrivateRoute;\nconst fakeAuth = {\n  isAuthenticated: false,\n\n  signin(cb) {\n    fakeAuth.isAuthenticated = true;\n    setTimeout(cb, 1000); // fake async\n  },\n\n  signout(cb) {\n    fakeAuth.isAuthenticated = false;\n    setTimeout(cb, 3000);\n  }\n\n}; // the authentication method\n\nfunction useProvideAuth() {\n  _s4();\n\n  function getRoles() {\n    const token = getAccessToken();\n    if (!token) return null;\n    const tokenDetails = JSON.parse(atob(token.split(\".\")[1]));\n    return tokenDetails.roles;\n  }\n\n  const [user, setUser] = useState(() => getRoles());\n\n  const signin = function () {\n    let cb = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : () => {};\n    setUser(getRoles());\n    cb(); // setTimeout(cb(), 500);\n    // return fakeAuth.signin(() => {\n    //   setUser(\"user\");\n    //   if(cb) cb();\n    // });\n  };\n\n  const signout = function () {\n    let cb = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : () => {};\n    setUser(null);\n    clearToken();\n    clearRoles();\n    clearLoanRoles();\n    clearBranchId();\n    clearEmail();\n    clearAllTokens(); // return fakeAuth.signout(() => {\n    //   setUser(null);\n    //   if(cb) cb();\n    // });\n  };\n\n  return {\n    user,\n    signin,\n    signout\n  };\n}\n\n_s4(useProvideAuth, \"XPIX9hLmcgCN1Pu0PXqYTWcXhCM=\");\n\nexport const handleOpenModal = function (modalSelector) {\n  let cb = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => {};\n  return document.$(modalSelector).modal(\"show\").on(\"hidden.bs.modal\", cb);\n};\nexport const handleHideModal = function (modalSelector) {\n  let cb = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : () => {};\n  return document.$(modalSelector).modal(\"hide\").on(\"hidden.bs.modal\", cb);\n};\nexport const isAlphaNumeric = string => {\n  let re = /^.*(?=.*[a-z])(?=.*\\d)/;\n  return re.test(string);\n};\nexport const isValidDate = date => {\n  console.log(date);\n  return !!(date && Object.prototype.toString.call(date) === \"[object Date]\" && !isNaN(date));\n};\nexport const formatAmount = amount => numeral(amount).format(\"0,0.00\");\nexport const useQueryParams = () => {\n  _s5();\n\n  return new URLSearchParams(useLocation().search);\n};\n\n_s5(useQueryParams, \"EuD9q2dZ34PfN/QO2OBhBzeMxmY=\", false, function () {\n  return [useLocation];\n});\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ProvideAuth\");\n$RefreshReg$(_c2, \"PrivateRoute\");","map":{"version":3,"sources":["/Users/xerde2/Downloads/npf-admin-web/src/components/utilities.js"],"names":["numeral","React","createContext","useContext","useState","Redirect","Route","useLocation","clearAllTokens","clearRoles","clearToken","clearLoanRoles","clearBranchId","getAccessToken","clearEmail","authContext","useAuth","_","ProvideAuth","props","auth","useProvideAuth","children","PrivateRoute","rest","location","user","pathname","state","from","fakeAuth","isAuthenticated","signin","cb","setTimeout","signout","getRoles","token","tokenDetails","JSON","parse","atob","split","roles","setUser","handleOpenModal","modalSelector","document","$","modal","on","handleHideModal","isAlphaNumeric","string","re","test","isValidDate","date","console","log","Object","prototype","toString","call","isNaN","formatAmount","amount","format","useQueryParams","URLSearchParams","search"],"mappings":"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","sourcesContent":["import numeral from \"numeral\";\nimport React, { createContext, useContext, useState } from \"react\";\nimport { Redirect, Route, useLocation } from \"react-router-dom\";\nimport {\n  clearAllTokens,\n  clearRoles,\n  clearToken,\n  clearLoanRoles,\n  clearBranchId,\n  getAccessToken,\n  clearEmail,\n} from \"../utils/localStorageService\";\n\nconst authContext = createContext();\n\nexport const useAuth = (_) => useContext(authContext);\n\n// app wrapper granting access to the authentication context\nexport const ProvideAuth = (props) => {\n  const auth = useProvideAuth();\n  return (\n    <authContext.Provider value={auth}>{props.children}</authContext.Provider>\n  );\n};\n\n// private route component\nexport const PrivateRoute = ({ children, ...rest }) => {\n  const auth = useAuth();\n  return (\n    <Route\n      {...rest}\n      render={({ location }) =>\n        auth.user ? (\n          children\n        ) : (\n          <Redirect\n            to={{\n              pathname: \"/login\",\n              state: { from: location },\n            }}\n          />\n        )\n      }\n    />\n  );\n};\n\n// fake authentication state object\nconst fakeAuth = {\n  isAuthenticated: false,\n  signin(cb) {\n    fakeAuth.isAuthenticated = true;\n    setTimeout(cb, 1000); // fake async\n  },\n  signout(cb) {\n    fakeAuth.isAuthenticated = false;\n    setTimeout(cb, 3000);\n  },\n};\n\n// the authentication method\nfunction useProvideAuth() {\n  function getRoles() {\n    const token = getAccessToken();\n    if (!token) return null;\n    const tokenDetails = JSON.parse(atob(token.split(\".\")[1]));\n    return tokenDetails.roles;\n  }\n  const [user, setUser] = useState(() => getRoles());\n\n  const signin = (cb = () => {}) => {\n    setUser(getRoles());\n    cb();\n    // setTimeout(cb(), 500);\n    // return fakeAuth.signin(() => {\n    //   setUser(\"user\");\n    //   if(cb) cb();\n    // });\n  };\n\n  const signout = (cb = () => {}) => {\n    setUser(null);\n    clearToken();\n    clearRoles();\n    clearLoanRoles();\n    clearBranchId();\n    clearEmail();\n    clearAllTokens();\n    // return fakeAuth.signout(() => {\n    //   setUser(null);\n    //   if(cb) cb();\n    // });\n  };\n\n  return {\n    user,\n    signin,\n    signout,\n  };\n}\n\nexport const handleOpenModal = (modalSelector, cb = () => {}) =>\n  document.$(modalSelector).modal(\"show\").on(\"hidden.bs.modal\", cb);\n\nexport const handleHideModal = (modalSelector, cb = () => {}) =>\n  document.$(modalSelector).modal(\"hide\").on(\"hidden.bs.modal\", cb);\n\nexport const isAlphaNumeric = (string) => {\n  let re = /^.*(?=.*[a-z])(?=.*\\d)/;\n  return re.test(string);\n};\n\nexport const isValidDate = (date) => {\n  console.log(date);\n  return !!(\n    date &&\n    Object.prototype.toString.call(date) === \"[object Date]\" &&\n    !isNaN(date)\n  );\n};\n\nexport const formatAmount = (amount) => numeral(amount).format(\"0,0.00\");\n\nexport const useQueryParams = () => {\n  return new URLSearchParams(useLocation().search);\n};\n"]},"metadata":{},"sourceType":"module"}