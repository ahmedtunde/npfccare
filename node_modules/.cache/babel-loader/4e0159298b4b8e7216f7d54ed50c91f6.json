{"ast":null,"code":"import _regeneratorRuntime from\"/Users/xerde2/Downloads/npf-admin-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/xerde2/Downloads/npf-admin-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/xerde2/Downloads/npf-admin-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/xerde2/Downloads/npf-admin-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/xerde2/Downloads/npf-admin-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import React,{Fragment,useState,useRef,useCallback}from\"react\";import{useHistory,useRouteMatch}from\"react-router-dom\";import face from\"../../../assets/img/placeholder-img.png\";import placeholderImg from\"../../../assets/img/placeholder-img.png\";import{ReactComponent as TimesIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../../assets/icons/times.svg\";import{ReactComponent as CheckCircleFill}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../../assets/icons/check-circle-fill.svg\";import{ReactComponent as ArrowRightShort}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../../assets/icons/arrow-right-short.svg\";import{ReactComponent as SearchIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../../assets/icons/search.svg\";import{ReactComponent as ArrowLeftShortCircleFill}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../../assets/icons/arrow-left-short-circle-fill.svg\";import{ReactComponent as SpinnerIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../../assets/icons/spinner.svg\";import{ReactComponent as NothingFoundIcon}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../../assets/icons/nothing-found.svg\";import{searchCustomers}from\"../../../services/customerService\";import errorHandler from\"../../../utils/errorHandler\";import notify from\"../../../utils/notification\";import{useAuth}from\"../../utilities\";import ReactPaginate from\"react-paginate\";var SelectCustomer=function SelectCustomer(props){var _useRouteMatch=useRouteMatch(),path=_useRouteMatch.path;var history=useHistory();var auth=useAuth();// useCallback ensures that handle error function isn't recreated on every render\nvar handleError=useCallback(function(errorObject,notify,cb){return errorHandler(auth)(errorObject,notify,cb);},[auth]);var _useState=useState(function(){return Array(0).fill(\"\").map(function(v,idx){return{id:\"40\".concat(idx),bvnhash:\"\",firstname:\"\",lastname:\"\",middlename:null,phone:\"\",simswapstatus:null,otpstatus:null,email:\"\",dob:\"1999-06-30T00:00:00.000Z\",pob:null,bucket:\"npf-mfb\",photo_location:\"\",photo_key:\"40/photo/livelinesscheck.png\",photo_number:null,video_location:\"\",video_key:\"\",signature_location:\"\",signature_key:\"\",document_location:\"\",document_key:\"\",document_number:\"\",document_type_id:2,documentschecked:null,isnewbankcustomer:null,document_issue_date:\"\",document_expiry_date:\"\",isotpverified:true,livelinesschecked:null,salary_officer:false,force_number:\"N/A\",ippis_number:\"N/A\",address:\"N/A\",has_pin:true,createdAt:\"2020-11-04T15:11:59.904Z\",updatedAt:\"2020-11-06T09:11:40.700Z\",user:62,accountNumber:\"0209525729\",bvn:\"\",accountStatus:idx===0||idx===2?false:true,liveliness:idx===0||idx===2?false:true,PND:true,signup_incomplete:false};});}),_useState2=_slicedToArray(_useState,2),customers=_useState2[0],setCustomers=_useState2[1];var _useState3=useState({search:\"\"}),_useState4=_slicedToArray(_useState3,2),values=_useState4[0],setValues=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),currentPage=_useState6[0],setCurrentPage=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLoading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(5),_useState10=_slicedToArray(_useState9,2),itemsPerPage=_useState10[0],setItemsPerPage=_useState10[1];var isSearching=useRef(false);var handleNavigateToCustomer=function handleNavigateToCustomer(e){var element=e.target;if(!element.classList.contains(\"action-btn\"))return;var userId=element.dataset.userId;history.push(\"\".concat(path.replace(\"/selectCustomer\",\"\"),\"?customer_id=\").concat(userId));};var handleChange=function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setValues(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},name,name===\"search\"?value.trim():value));});if(name===\"search\")handleSearchCustomers(value);};var handleSearchCustomers=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(searchPhrase){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setCurrentPage(1);// setFilter(\"\");\nif(searchPhrase){_context.next=6;break;}isSearching.current=false;setLoading(false);setCustomers([]);return _context.abrupt(\"return\");case 6:isSearching.current=true;setLoading(true);_context.prev=8;_context.next=11;return searchCustomers(searchPhrase);case 11:result=_context.sent;setLoading(false);if(!result.error){_context.next=15;break;}return _context.abrupt(\"return\",notify(result.message,\"error\"));case 15:isSearching.current&&setCustomers(result.result);isSearching.current=false;_context.next=22;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](8);handleError(_context.t0,notify,function(){return setLoading(false);});case 22:case\"end\":return _context.stop();}}},_callee,null,[[8,19]]);}));return function handleSearchCustomers(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"header\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"h1\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){return history.goBack();},className:\"btn btn-primary back-btn\",children:/*#__PURE__*/_jsx(ArrowRightShort,{})}),\"Select Customer for New Loan\"]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"small-admin-details\",children:[/*#__PURE__*/_jsx(\"img\",{src:face,alt:\"\"}),\"NPF Admin\",/*#__PURE__*/_jsx(\"i\",{className:\"arrow down\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"some-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"search-div\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"search\",children:/*#__PURE__*/_jsx(SearchIcon,{})}),/*#__PURE__*/_jsx(\"input\",{type:\"search\",className:\"form-control\",name:\"search\",id:\"search\",\"aria-label\":\"Search for customers\",value:values.search,onChange:handleChange})]})})]})]}),/*#__PURE__*/_jsxs(\"main\",{className:\"customers-page\",children:[(isLoading||customers.length===0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"searching-block\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"svg-holder \"+(!isLoading?\"not-loading\":\"\"),children:isLoading?/*#__PURE__*/_jsx(SpinnerIcon,{className:\"rotating\"}):/*#__PURE__*/_jsx(NothingFoundIcon,{})}),!isLoading&&/*#__PURE__*/_jsx(\"p\",{children:values.search?\"NOTHING FOUND!\":\"You can search for the customer with the top right search bar\"})]}),!isLoading&&customers.length!==0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"color-dark-text-blue\",children:[\"Customers per page:\",\" \",/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",style:{display:\"inline-block\"},children:/*#__PURE__*/_jsxs(\"select\",{className:\"form-control\",onChange:function onChange(e){setItemsPerPage(e.target.value);setCurrentPage(1);},value:itemsPerPage,children:[/*#__PURE__*/_jsx(\"option\",{value:5,children:\"5\"}),/*#__PURE__*/_jsx(\"option\",{value:10,children:\"10\"}),/*#__PURE__*/_jsx(\"option\",{value:20,children:\"20\"}),/*#__PURE__*/_jsx(\"option\",{value:50,children:\"50\"}),/*#__PURE__*/_jsx(\"option\",{value:100,children:\"100\"}),/*#__PURE__*/_jsx(\"option\",{value:150,children:\"150\"}),/*#__PURE__*/_jsx(\"option\",{value:200,children:\"200\"})]})})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-borderless table-hover\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"color-dark-text-blue\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"BVN\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Phone\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Account Status\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Facial Liveliness Check\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Action\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{onClick:handleNavigateToCustomer,children:[/*#__PURE__*/_jsx(\"tr\",{className:\"spacer\"}),customers.map(function(v,idx){var initialBoundary=(currentPage-1)*itemsPerPage+1;var finalBoundary=currentPage*itemsPerPage;var itemNumber=idx+1;if(itemNumber<initialBoundary||itemNumber>finalBoundary)return null;var pseudoAccStatus=!v.PND;var showIncompleteBadge=v.signup_incomplete;return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsxs(\"tr\",{className:\"customer-card\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"major-details\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"customer-img\",children:/*#__PURE__*/_jsx(\"img\",{src:v.photo_location||placeholderImg,className:\"\",alt:\"\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"name font-weight-bold\",children:[v.firstname,\" \",v.lastname,showIncompleteBadge&&\" (Incomplete)\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"email font-weight-light\",children:v.email})]})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"bvn font-weight-light\",children:v.bvnhash||\"N/A\"}),/*#__PURE__*/_jsxs(\"td\",{className:\"phone font-weight-light\",children:[\"(234) \",v.phone.replace(\"234\",\"0\")]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"account-status \".concat(pseudoAccStatus?\"active\":\"pending\"),children:pseudoAccStatus?\"ACTIVE\":\"PND\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"liveliness \".concat(v.video_location?\"provided\":\"\"),children:[v.video_location?/*#__PURE__*/_jsx(CheckCircleFill,{}):/*#__PURE__*/_jsx(TimesIcon,{}),v.video_location?\" P\":\"Not p\",\"rovided\"]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{\"data-user-id\":v.id,className:\"btn btn-success action-btn\",children:\"Continue\"})})]}),idx!==customers.length-1&&/*#__PURE__*/_jsx(\"tr\",{className:\"spacer\"})]},\"\".concat(v.user,\" + \").concat(idx));})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"audit-history-footer\",children:/*#__PURE__*/_jsx(ReactPaginate,{pageCount:Math.ceil(customers.length/itemsPerPage)||1,marginPagesDisplayed:2,pageRangeDisplayed:3,forcePage:currentPage-1,onPageChange:function onPageChange(selectedItem){return setCurrentPage(selectedItem.selected+1);},containerClassName:\"pagination-btns\",activeLinkClassName:\"active\",pageLinkClassName:\"btn\",previousLabel:/*#__PURE__*/_jsx(ArrowLeftShortCircleFill,{}),previousLinkClassName:\"btn icon\",nextLabel:/*#__PURE__*/_jsx(ArrowLeftShortCircleFill,{style:{transform:\"rotateY(180deg)\"}}),nextLinkClassName:\"btn icon\",disabledClassName:\"disabled\"})}),\" \"]})]})]});};export default SelectCustomer;","map":{"version":3,"sources":["/Users/xerde2/Downloads/npf-admin-web/src/components/loanManagement/newApplications/selectCustomer.js"],"names":["React","Fragment","useState","useRef","useCallback","useHistory","useRouteMatch","face","placeholderImg","searchCustomers","errorHandler","notify","useAuth","ReactPaginate","SelectCustomer","props","path","history","auth","handleError","errorObject","cb","Array","fill","map","v","idx","id","bvnhash","firstname","lastname","middlename","phone","simswapstatus","otpstatus","email","dob","pob","bucket","photo_location","photo_key","photo_number","video_location","video_key","signature_location","signature_key","document_location","document_key","document_number","document_type_id","documentschecked","isnewbankcustomer","document_issue_date","document_expiry_date","isotpverified","livelinesschecked","salary_officer","force_number","ippis_number","address","has_pin","createdAt","updatedAt","user","accountNumber","bvn","accountStatus","liveliness","PND","signup_incomplete","customers","setCustomers","search","values","setValues","currentPage","setCurrentPage","isLoading","setLoading","itemsPerPage","setItemsPerPage","isSearching","handleNavigateToCustomer","e","element","target","classList","contains","userId","dataset","push","replace","handleChange","name","value","prev","trim","handleSearchCustomers","searchPhrase","current","result","error","message","goBack","length","display","initialBoundary","finalBoundary","itemNumber","pseudoAccStatus","showIncompleteBadge","Math","ceil","selectedItem","selected","transform"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useRef, useCallback } from \"react\";\nimport { useHistory, useRouteMatch } from \"react-router-dom\";\nimport face from \"../../../assets/img/placeholder-img.png\";\nimport placeholderImg from \"../../../assets/img/placeholder-img.png\";\nimport { ReactComponent as TimesIcon } from \"../../../assets/icons/times.svg\";\nimport { ReactComponent as CheckCircleFill } from \"../../../assets/icons/check-circle-fill.svg\";\nimport { ReactComponent as ArrowRightShort } from \"../../../assets/icons/arrow-right-short.svg\";\nimport { ReactComponent as SearchIcon } from \"../../../assets/icons/search.svg\";\nimport { ReactComponent as ArrowLeftShortCircleFill } from \"../../../assets/icons/arrow-left-short-circle-fill.svg\";\nimport { ReactComponent as SpinnerIcon } from \"../../../assets/icons/spinner.svg\";\nimport { ReactComponent as NothingFoundIcon } from \"../../../assets/icons/nothing-found.svg\";\nimport { searchCustomers } from \"../../../services/customerService\";\nimport errorHandler from \"../../../utils/errorHandler\";\nimport notify from \"../../../utils/notification\";\nimport { useAuth } from \"../../utilities\";\nimport ReactPaginate from \"react-paginate\";\n\nconst SelectCustomer = (props) => {\n  const { path } = useRouteMatch();\n  const history = useHistory();\n  const auth = useAuth();\n  // useCallback ensures that handle error function isn't recreated on every render\n  const handleError = useCallback(\n    (errorObject, notify, cb) => errorHandler(auth)(errorObject, notify, cb),\n    [auth]\n  );\n\n  const [customers, setCustomers] = useState(() =>\n    Array(0)\n      .fill(\"\")\n      .map((v, idx) => ({\n        id: `40${idx}`,\n        bvnhash: \"\",\n        firstname: \"\",\n        lastname: \"\",\n        middlename: null,\n        phone: \"\",\n        simswapstatus: null,\n        otpstatus: null,\n        email: \"\",\n        dob: \"1999-06-30T00:00:00.000Z\",\n        pob: null,\n        bucket: \"npf-mfb\",\n        photo_location: \"\",\n        photo_key: \"40/photo/livelinesscheck.png\",\n        photo_number: null,\n        video_location: \"\",\n        video_key: \"\",\n        signature_location: \"\",\n        signature_key: \"\",\n        document_location: \"\",\n        document_key: \"\",\n        document_number: \"\",\n        document_type_id: 2,\n        documentschecked: null,\n        isnewbankcustomer: null,\n        document_issue_date: \"\",\n        document_expiry_date: \"\",\n        isotpverified: true,\n        livelinesschecked: null,\n        salary_officer: false,\n        force_number: \"N/A\",\n        ippis_number: \"N/A\",\n        address: \"N/A\",\n        has_pin: true,\n        createdAt: \"2020-11-04T15:11:59.904Z\",\n        updatedAt: \"2020-11-06T09:11:40.700Z\",\n        user: 62,\n        accountNumber: \"0209525729\",\n        bvn: \"\",\n        accountStatus: idx === 0 || idx === 2 ? false : true,\n        liveliness: idx === 0 || idx === 2 ? false : true,\n        PND: true,\n        signup_incomplete: false,\n      }))\n  );\n\n  const [values, setValues] = useState({\n    search: \"\",\n  });\n  const [currentPage, setCurrentPage] = useState(1);\n  const [isLoading, setLoading] = useState(false);\n  const [itemsPerPage, setItemsPerPage] = useState(5);\n  const isSearching = useRef(false);\n\n  const handleNavigateToCustomer = (e) => {\n    const element = e.target;\n    if (!element.classList.contains(\"action-btn\")) return;\n    const userId = element.dataset.userId;\n    history.push(\n      `${path.replace(\"/selectCustomer\", \"\")}?customer_id=${userId}`\n    );\n  };\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n\n    setValues((prev) => ({\n      ...prev,\n      [name]: name === \"search\" ? value.trim() : value,\n    }));\n\n    if (name === \"search\") handleSearchCustomers(value);\n  };\n\n  const handleSearchCustomers = async (searchPhrase) => {\n    setCurrentPage(1);\n    // setFilter(\"\");\n    if (!searchPhrase) {\n      isSearching.current = false;\n      setLoading(false);\n      setCustomers([]);\n      return;\n    }\n    isSearching.current = true;\n    setLoading(true);\n    try {\n      const result = await searchCustomers(searchPhrase);\n      setLoading(false);\n      if (result.error) return notify(result.message, \"error\");\n      isSearching.current && setCustomers(result.result);\n      isSearching.current = false;\n    } catch (error) {\n      handleError(error, notify, () => setLoading(false));\n    }\n  };\n\n  return (\n    <>\n      <header>\n        <div>\n          <h1>\n            <button\n              onClick={(e) => history.goBack()}\n              className=\"btn btn-primary back-btn\"\n            >\n              <ArrowRightShort />\n            </button>\n            Select Customer for New Loan\n          </h1>\n        </div>\n        <div>\n          <div className=\"small-admin-details\">\n            <img src={face} alt=\"\" />\n            NPF Admin\n            <i className=\"arrow down\"></i>\n          </div>\n          <div className=\"some-container\">\n            <div className=\"search-div\">\n              <label htmlFor=\"search\">\n                <SearchIcon />\n              </label>\n              <input\n                type=\"search\"\n                className=\"form-control\"\n                name=\"search\"\n                id=\"search\"\n                aria-label=\"Search for customers\"\n                value={values.search}\n                onChange={handleChange}\n              />\n            </div>\n          </div>\n        </div>\n      </header>\n      <main className=\"customers-page\">\n        {(isLoading || customers.length === 0) && (\n          <div className=\"searching-block\">\n            <div className={\"svg-holder \" + (!isLoading ? \"not-loading\" : \"\")}>\n              {isLoading ? (\n                <SpinnerIcon className=\"rotating\" />\n              ) : (\n                <NothingFoundIcon />\n              )}\n            </div>\n            {!isLoading && (\n              <p>\n                {values.search\n                  ? \"NOTHING FOUND!\"\n                  : \"You can search for the customer with the top right search bar\"}\n              </p>\n            )}\n          </div>\n        )}\n        {!isLoading && customers.length !== 0 && (\n          <>\n            <div className=\"color-dark-text-blue\">\n              Customers per page:{\" \"}\n              <div className=\"form-group\" style={{ display: \"inline-block\" }}>\n                <select\n                  className=\"form-control\"\n                  onChange={(e) => {\n                    setItemsPerPage(e.target.value);\n                    setCurrentPage(1);\n                  }}\n                  value={itemsPerPage}\n                >\n                  <option value={5}>5</option>\n                  <option value={10}>10</option>\n                  <option value={20}>20</option>\n                  <option value={50}>50</option>\n                  <option value={100}>100</option>\n                  <option value={150}>150</option>\n                  <option value={200}>200</option>\n                </select>\n              </div>\n            </div>\n            <table className=\"table table-borderless table-hover\">\n              <thead className=\"color-dark-text-blue\">\n                <tr>\n                  <th scope=\"col\">Customer</th>\n                  <th scope=\"col\">BVN</th>\n                  <th scope=\"col\">Phone</th>\n                  <th scope=\"col\">Account Status</th>\n                  <th scope=\"col\">Facial Liveliness Check</th>\n                  <th scope=\"col\">Action</th>\n                </tr>\n              </thead>\n              <tbody onClick={handleNavigateToCustomer}>\n                <tr className=\"spacer\" />\n                {customers.map((v, idx) => {\n                  const initialBoundary = (currentPage - 1) * itemsPerPage + 1;\n                  const finalBoundary = currentPage * itemsPerPage;\n                  const itemNumber = idx + 1;\n                  if (\n                    itemNumber < initialBoundary ||\n                    itemNumber > finalBoundary\n                  )\n                    return null;\n\n                  const pseudoAccStatus = !v.PND;\n                  const showIncompleteBadge = v.signup_incomplete;\n\n                  return (\n                    <Fragment key={`${v.user} + ${idx}`}>\n                      <tr className=\"customer-card\">\n                        <td className=\"major-details\">\n                          <div className=\"row\">\n                            <div className=\"customer-img\">\n                              <img\n                                src={v.photo_location || placeholderImg}\n                                className=\"\"\n                                alt=\"\"\n                              />\n                            </div>\n                            <div className=\"col\">\n                              <div className=\"name font-weight-bold\">\n                                {v.firstname} {v.lastname}\n                                {showIncompleteBadge && \" (Incomplete)\"}\n                              </div>\n                              <div className=\"email font-weight-light\">\n                                {v.email}\n                              </div>\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"bvn font-weight-light\">\n                          {v.bvnhash || \"N/A\"}\n                        </td>\n                        <td className=\"phone font-weight-light\">\n                          (234) {v.phone.replace(\"234\", \"0\")}\n                        </td>\n                        <td>\n                          <span\n                            className={`account-status ${\n                              pseudoAccStatus ? \"active\" : \"pending\"\n                            }`}\n                          >\n                            {pseudoAccStatus ? \"ACTIVE\" : \"PND\"}\n                          </span>\n                        </td>\n                        <td>\n                          <span\n                            className={`liveliness ${\n                              v.video_location ? \"provided\" : \"\"\n                            }`}\n                          >\n                            {v.video_location ? (\n                              <CheckCircleFill />\n                            ) : (\n                              <TimesIcon />\n                            )}\n                            {v.video_location ? \" P\" : \"Not p\"}rovided\n                          </span>\n                        </td>\n                        <td>\n                          <button\n                            data-user-id={v.id}\n                            className=\"btn btn-success action-btn\"\n                          >\n                            Continue\n                          </button>\n                        </td>\n                      </tr>\n                      {idx !== customers.length - 1 && (\n                        <tr className=\"spacer\" />\n                      )}\n                    </Fragment>\n                  );\n                })}\n              </tbody>\n            </table>\n            <div className=\"audit-history-footer\">\n              <ReactPaginate\n                pageCount={Math.ceil(customers.length / itemsPerPage) || 1}\n                marginPagesDisplayed={2}\n                pageRangeDisplayed={3}\n                forcePage={currentPage - 1}\n                onPageChange={(selectedItem) =>\n                  setCurrentPage(selectedItem.selected + 1)\n                }\n                containerClassName=\"pagination-btns\"\n                activeLinkClassName=\"active\"\n                pageLinkClassName=\"btn\"\n                previousLabel={<ArrowLeftShortCircleFill />}\n                previousLinkClassName=\"btn icon\"\n                nextLabel={\n                  <ArrowLeftShortCircleFill\n                    style={{ transform: \"rotateY(180deg)\" }}\n                  />\n                }\n                nextLinkClassName=\"btn icon\"\n                disabledClassName=\"disabled\"\n              />\n            </div>{\" \"}\n          </>\n        )}\n      </main>\n    </>\n  );\n};\n\nexport default SelectCustomer;\n"]},"metadata":{},"sourceType":"module"}