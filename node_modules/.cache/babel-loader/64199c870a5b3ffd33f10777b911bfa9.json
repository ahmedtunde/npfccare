{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/xerde2/Downloads/npf-admin-web/src/components/customerBillingHistory.js\",\n    _s = $RefreshSig$();\n\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport moment from \"moment\";\nimport { ReactComponent as NothingFoundIcon } from \"@svgr/webpack?-svgo,+titleProp,+ref!../assets/icons/nothing-found.svg\";\nimport { ReactComponent as SpinnerIcon } from \"@svgr/webpack?-svgo,+titleProp,+ref!../assets/icons/spinner.svg\";\nimport { ReactComponent as ArrowLeftShortCircleFill } from \"@svgr/webpack?-svgo,+titleProp,+ref!../assets/icons/arrow-left-short-circle-fill.svg\";\nimport { getCustomerBillings, getBillingStatus } from \"../services/customerService\";\nimport notify from \"../utils/notification\";\nimport errorHandler from \"../utils/errorHandler\";\nimport { handleOpenModal, useAuth } from \"./utilities\";\nimport ReactPaginate from \"react-paginate\";\nimport numeral from \"numeral\";\nimport BillingStatusModal from \"./billingStatusModal\";\n\nconst CustomerBillingHistory = props => {\n  _s();\n\n  const [billingEntries, setBillingEntries] = useState(Array(0).fill(\"a\").map((v, idx) => ({\n    amountDue: \"200.00\",\n    rrr: \"000000\",\n    status: \"FAILED\",\n    date: \"2021-04-14T08:54:08.181Z\",\n    description: \"Eko Prepaid Bills\",\n    funds_deduction: \"\"\n  })));\n  const [billingStatus, setBillingStatus] = useState({\n    rrr: \"\",\n    amountDue: 200,\n    chargeFee: 100,\n    rrrAmount: 100,\n    payerEmail: \"\",\n    payerName: \"\",\n    payerPhone: \"\",\n    description: \"\",\n    currency: \"\",\n    type: \"\",\n    acceptPartPayment: false,\n    message: \"\"\n  });\n  const auth = useAuth();\n  const [itemsPerPage, setItemsPerPage] = useState(5);\n  const handleError = errorHandler(auth);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [isLoading, setLoading] = useState(false);\n  const [isStatusFetching, setStatusFetching] = useState(\"\");\n  const {\n    userId\n  } = props;\n  useEffect(() => {\n    handleGetCustomerBillings(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleGetCustomerBillings = async function () {\n    let customer_id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : userId;\n    setLoading(true);\n\n    try {\n      const result = await getCustomerBillings(customer_id);\n      setLoading(false);\n      if (result.error) return notify(result.message, \"error\");\n      setBillingEntries(result.result);\n    } catch (error) {\n      handleError(error, notify, () => setLoading(false));\n    }\n  };\n\n  const handleShowBillingStatus = async e => {\n    const element = e.target;\n    if (!element.classList.contains(\"action-btn\")) return;\n    const rrr = element.dataset.rrr;\n\n    try {\n      setStatusFetching(rrr);\n      const result = await getBillingStatus(rrr);\n      setStatusFetching(\"\");\n      if (result.error) return notify(result.message, \"error\");\n      setBillingStatus({ ...result.result,\n        message: result.message\n      });\n      handleOpenModal(\"#billingStatusModal\");\n    } catch (error) {\n      handleError(error, notify, () => setStatusFetching(\"\"));\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [(isLoading || billingEntries.length === 0) && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"searching-block\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"svg-holder \" + (!isLoading ? \"not-loading\" : \"\"),\n        children: isLoading ? /*#__PURE__*/_jsxDEV(SpinnerIcon, {\n          className: \"rotating\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 15\n        }, this) : /*#__PURE__*/_jsxDEV(NothingFoundIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }, this), !isLoading && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"NOTHING FOUND!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 26\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }, this), !isLoading && billingEntries.length !== 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Entries per page:\", \" \", /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          style: {\n            display: \"inline-block\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"select\", {\n            className: \"form-control\",\n            onChange: e => setItemsPerPage(e.target.value),\n            value: itemsPerPage,\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: 5,\n              children: \"5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: 10,\n              children: \"10\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: 20,\n              children: \"20\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: 50,\n              children: \"50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: 100,\n              children: \"100\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: 150,\n              children: \"150\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: 200,\n              children: \"200\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"table table-borderless\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          className: \"color-dark-text-blue\",\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              scope: \"col\",\n              children: \"Date\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              scope: \"col\",\n              children: \"Description\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              scope: \"col-3\",\n              children: \"RRR\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              scope: \"col\",\n              children: \"Amount Due\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              scope: \"col\",\n              children: \"Funds Deduction\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              scope: \"col\",\n              children: \"Status\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 135,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              scope: \"col\",\n              className: \"text-center\",\n              children: \"Actions\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          onClick: handleShowBillingStatus,\n          children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n            className: \"spacer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 15\n          }, this), billingEntries.map((v, idx) => {\n            const initialBoundary = (currentPage - 1) * itemsPerPage + 1;\n            const finalBoundary = currentPage * itemsPerPage;\n            const itemNumber = idx + 1;\n            if (itemNumber < initialBoundary || itemNumber > finalBoundary) return null;\n            return /*#__PURE__*/_jsxDEV(Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"billing-history-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"\",\n                  children: moment(v.date).format(\"MMMM Do, YYYY\")\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 155,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"\",\n                  children: v.description\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"\",\n                  children: v.rrr\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 159,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"\",\n                  children: [\"\\u20A6\", numeral(v.amountDue).format(\"0,0.00\")]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 160,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"\",\n                  children: v.funds_deduction || \"N/A\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: `${v.status === \"SUCCESSFUL\" ? \"text-success\" : v.status === \"FAILED\" ? \"text-danger\" : \"\"}`,\n                  children: v.status\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"text-center\",\n                  children: /*#__PURE__*/_jsxDEV(\"button\", {\n                    \"data-rrr\": v.rrr,\n                    className: \"btn btn-success action-btn\",\n                    disabled: isStatusFetching,\n                    children: isStatusFetching === v.rrr ? /*#__PURE__*/_jsxDEV(SpinnerIcon, {\n                      className: \"rotating\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 182,\n                      columnNumber: 29\n                    }, this) : \"View\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 176,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 175,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 21\n              }, this), idx !== billingEntries.length - 1 && /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"spacer\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 23\n              }, this)]\n            }, idx, true, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 19\n            }, this);\n          })]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"audit-history-footer\",\n        children: /*#__PURE__*/_jsxDEV(ReactPaginate, {\n          pageCount: Math.ceil(billingEntries.length / itemsPerPage) || 1,\n          marginPagesDisplayed: 2,\n          pageRangeDisplayed: 3,\n          forcePage: currentPage - 1,\n          onPageChange: selectedItem => setCurrentPage(selectedItem.selected + 1),\n          containerClassName: \"pagination-btns\",\n          activeLinkClassName: \"active\",\n          pageLinkClassName: \"btn\",\n          previousLabel: /*#__PURE__*/_jsxDEV(ArrowLeftShortCircleFill, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 30\n          }, this),\n          previousLinkClassName: \"btn icon\",\n          nextLabel: /*#__PURE__*/_jsxDEV(ArrowLeftShortCircleFill, {\n            style: {\n              transform: \"rotateY(180deg)\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 17\n          }, this),\n          nextLinkClassName: \"btn icon\",\n          disabledClassName: \"disabled\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true), /*#__PURE__*/_jsxDEV(BillingStatusModal, {\n      billingStatus: billingStatus\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(CustomerBillingHistory, \"4wWuo+K5kNKA2GzVerr80yRNgoE=\", false, function () {\n  return [useAuth];\n});\n\n_c = CustomerBillingHistory;\nexport default CustomerBillingHistory;\n\nvar _c;\n\n$RefreshReg$(_c, \"CustomerBillingHistory\");","map":{"version":3,"sources":["/Users/xerde2/Downloads/npf-admin-web/src/components/customerBillingHistory.js"],"names":["React","Fragment","useEffect","useState","moment","getCustomerBillings","getBillingStatus","notify","errorHandler","handleOpenModal","useAuth","ReactPaginate","numeral","BillingStatusModal","CustomerBillingHistory","props","billingEntries","setBillingEntries","Array","fill","map","v","idx","amountDue","rrr","status","date","description","funds_deduction","billingStatus","setBillingStatus","chargeFee","rrrAmount","payerEmail","payerName","payerPhone","currency","type","acceptPartPayment","message","auth","itemsPerPage","setItemsPerPage","handleError","currentPage","setCurrentPage","isLoading","setLoading","isStatusFetching","setStatusFetching","userId","handleGetCustomerBillings","customer_id","result","error","handleShowBillingStatus","e","element","target","classList","contains","dataset","length","display","value","initialBoundary","finalBoundary","itemNumber","format","Math","ceil","selectedItem","selected","transform"],"mappings":"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","sourcesContent":["import React, { Fragment, useEffect, useState } from \"react\";\nimport moment from \"moment\";\nimport { ReactComponent as NothingFoundIcon } from \"../assets/icons/nothing-found.svg\";\nimport { ReactComponent as SpinnerIcon } from \"../assets/icons/spinner.svg\";\nimport { ReactComponent as ArrowLeftShortCircleFill } from \"../assets/icons/arrow-left-short-circle-fill.svg\";\nimport {\n  getCustomerBillings,\n  getBillingStatus,\n} from \"../services/customerService\";\nimport notify from \"../utils/notification\";\nimport errorHandler from \"../utils/errorHandler\";\nimport { handleOpenModal, useAuth } from \"./utilities\";\nimport ReactPaginate from \"react-paginate\";\nimport numeral from \"numeral\";\nimport BillingStatusModal from \"./billingStatusModal\";\n\nconst CustomerBillingHistory = (props) => {\n  const [billingEntries, setBillingEntries] = useState(\n    Array(0)\n      .fill(\"a\")\n      .map((v, idx) => ({\n        amountDue: \"200.00\",\n        rrr: \"000000\",\n        status: \"FAILED\",\n        date: \"2021-04-14T08:54:08.181Z\",\n        description: \"Eko Prepaid Bills\",\n        funds_deduction: \"\",\n      }))\n  );\n  const [billingStatus, setBillingStatus] = useState({\n    rrr: \"\",\n    amountDue: 200,\n    chargeFee: 100,\n    rrrAmount: 100,\n    payerEmail: \"\",\n    payerName: \"\",\n    payerPhone: \"\",\n    description: \"\",\n    currency: \"\",\n    type: \"\",\n    acceptPartPayment: false,\n    message: \"\",\n  });\n  const auth = useAuth();\n  const [itemsPerPage, setItemsPerPage] = useState(5);\n  const handleError = errorHandler(auth);\n\n  const [currentPage, setCurrentPage] = useState(1);\n\n  const [isLoading, setLoading] = useState(false);\n  const [isStatusFetching, setStatusFetching] = useState(\"\");\n  const { userId } = props;\n\n  useEffect(() => {\n    handleGetCustomerBillings();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleGetCustomerBillings = async (customer_id = userId) => {\n    setLoading(true);\n    try {\n      const result = await getCustomerBillings(customer_id);\n      setLoading(false);\n      if (result.error) return notify(result.message, \"error\");\n      setBillingEntries(result.result);\n    } catch (error) {\n      handleError(error, notify, () => setLoading(false));\n    }\n  };\n\n  const handleShowBillingStatus = async (e) => {\n    const element = e.target;\n    if (!element.classList.contains(\"action-btn\")) return;\n    const rrr = element.dataset.rrr;\n    try {\n      setStatusFetching(rrr);\n      const result = await getBillingStatus(rrr);\n      setStatusFetching(\"\");\n      if (result.error) return notify(result.message, \"error\");\n      setBillingStatus({\n        ...result.result,\n        message: result.message,\n      });\n      handleOpenModal(\"#billingStatusModal\");\n    } catch (error) {\n      handleError(error, notify, () => setStatusFetching(\"\"));\n    }\n  };\n\n  return (\n    <>\n      {(isLoading || billingEntries.length === 0) && (\n        <div className=\"searching-block\">\n          <div className={\"svg-holder \" + (!isLoading ? \"not-loading\" : \"\")}>\n            {isLoading ? (\n              <SpinnerIcon className=\"rotating\" />\n            ) : (\n              <NothingFoundIcon />\n            )}\n          </div>\n          {!isLoading && <p>NOTHING FOUND!</p>}\n        </div>\n      )}\n      {!isLoading && billingEntries.length !== 0 && (\n        <>\n          <div>\n            Entries per page:{\" \"}\n            <div className=\"form-group\" style={{ display: \"inline-block\" }}>\n              <select\n                className=\"form-control\"\n                onChange={(e) => setItemsPerPage(e.target.value)}\n                value={itemsPerPage}\n              >\n                <option value={5}>5</option>\n                <option value={10}>10</option>\n                <option value={20}>20</option>\n                <option value={50}>50</option>\n                <option value={100}>100</option>\n                <option value={150}>150</option>\n                <option value={200}>200</option>\n              </select>\n            </div>\n          </div>\n          <table className=\"table table-borderless\">\n            <thead className=\"color-dark-text-blue\">\n              <tr>\n                {/* <th scope=\"col\">\n              <input type=\"checkbox\" />\n            </th> */}\n                <th scope=\"col\">Date</th>\n                <th scope=\"col\">Description</th>\n                <th scope=\"col-3\">RRR</th>\n                <th scope=\"col\">Amount Due</th>\n                <th scope=\"col\">Funds Deduction</th>\n                <th scope=\"col\">Status</th>\n                <th scope=\"col\" className=\"text-center\">\n                  Actions\n                </th>\n              </tr>\n            </thead>\n            <tbody onClick={handleShowBillingStatus}>\n              <tr className=\"spacer\" />\n              {billingEntries.map((v, idx) => {\n                const initialBoundary = (currentPage - 1) * itemsPerPage + 1;\n                const finalBoundary = currentPage * itemsPerPage;\n                const itemNumber = idx + 1;\n                if (itemNumber < initialBoundary || itemNumber > finalBoundary)\n                  return null;\n                return (\n                  <Fragment key={idx}>\n                    <tr className=\"billing-history-card\">\n                      {/* <th scope=\"row\">\n                    <input type=\"checkbox\" />\n                  </th> */}\n                      <td className=\"\">\n                        {moment(v.date).format(\"MMMM Do, YYYY\")}\n                      </td>\n                      <td className=\"\">{v.description}</td>\n                      <td className=\"\">{v.rrr}</td>\n                      <td className=\"\">\n                        &#8358;{numeral(v.amountDue).format(\"0,0.00\")}\n                      </td>\n                      <td className=\"\">{v.funds_deduction || \"N/A\"}</td>\n                      <td\n                        className={`${\n                          v.status === \"SUCCESSFUL\"\n                            ? \"text-success\"\n                            : v.status === \"FAILED\"\n                            ? \"text-danger\"\n                            : \"\"\n                        }`}\n                      >\n                        {v.status}\n                      </td>\n                      <td className=\"text-center\">\n                        <button\n                          data-rrr={v.rrr}\n                          className=\"btn btn-success action-btn\"\n                          disabled={isStatusFetching}\n                        >\n                          {isStatusFetching === v.rrr ? (\n                            <SpinnerIcon className=\"rotating\" />\n                          ) : (\n                            \"View\"\n                          )}\n                        </button>\n                      </td>\n                    </tr>\n                    {idx !== billingEntries.length - 1 && (\n                      <tr className=\"spacer\" />\n                    )}\n                  </Fragment>\n                );\n              })}\n            </tbody>\n          </table>\n          <div className=\"audit-history-footer\">\n            <ReactPaginate\n              pageCount={Math.ceil(billingEntries.length / itemsPerPage) || 1}\n              marginPagesDisplayed={2}\n              pageRangeDisplayed={3}\n              forcePage={currentPage - 1}\n              onPageChange={(selectedItem) =>\n                setCurrentPage(selectedItem.selected + 1)\n              }\n              containerClassName=\"pagination-btns\"\n              activeLinkClassName=\"active\"\n              pageLinkClassName=\"btn\"\n              previousLabel={<ArrowLeftShortCircleFill />}\n              previousLinkClassName=\"btn icon\"\n              nextLabel={\n                <ArrowLeftShortCircleFill\n                  style={{ transform: \"rotateY(180deg)\" }}\n                />\n              }\n              nextLinkClassName=\"btn icon\"\n              disabledClassName=\"disabled\"\n            />\n          </div>\n        </>\n      )}\n\n      <BillingStatusModal billingStatus={billingStatus} />\n    </>\n  );\n};\n\nexport default CustomerBillingHistory;\n"]},"metadata":{},"sourceType":"module"}